{
    "swagger": "2.0",
    "info": {
        "description": "API for ForexFactory calendar data, live positions, trade history, and analytics.",
        "title": "Forex Trading Server API",
        "contact": {},
        "version": "1.0"
    },
    "basePath": "/api/v1",
    "paths": {
        "/events": {
            "get": {
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "calendar"
                ],
                "summary": "List calendar events",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "Maximum number of events",
                        "name": "limit",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Filter events with event_date greater than or equal to this ISO8601 timestamp",
                        "name": "date_from",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Filter events with event_date less than or equal to this ISO8601 timestamp",
                        "name": "date_to",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/domain.CalendarEvent"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "/events/sync": {
            "post": {
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "calendar"
                ],
                "summary": "Trigger a calendar sync",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "integer"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "/report/{login}": {
            "get": {
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "trading"
                ],
                "summary": "Get performance report by login",
                "parameters": [
                    {
                        "type": "string",
                        "description": "User login",
                        "name": "login",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "integer",
                        "description": "Maximum history window",
                        "name": "limit",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/domain.UserPerformanceReport"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "/trading-data": {
            "post": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "trading"
                ],
                "summary": "Handle trading data (positions or history)",
                "parameters": [
                    {
                        "description": "Trading data payload",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/http.TradingDataRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "/users": {
            "get": {
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "users"
                ],
                "summary": "List users",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "Maximum number of users",
                        "name": "limit",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/domain.User"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "/users/{user_id}/positions": {
            "post": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "trading"
                ],
                "summary": "Upsert a live position snapshot",
                "parameters": [
                    {
                        "type": "string",
                        "description": "User ID",
                        "name": "user_id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "Position payload",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/http.PositionRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "/users/{user_id}/report": {
            "get": {
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "trading"
                ],
                "summary": "Generate a performance report for a user",
                "parameters": [
                    {
                        "type": "string",
                        "description": "User ID",
                        "name": "user_id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "integer",
                        "description": "Maximum history window",
                        "name": "limit",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/domain.UserPerformanceReport"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "/users/{user_id}/trades": {
            "post": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "trading"
                ],
                "summary": "Record a trade history entry",
                "parameters": [
                    {
                        "type": "string",
                        "description": "User ID",
                        "name": "user_id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "Trade payload",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/http.TradeRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "domain.CalendarEvent": {
            "type": "object",
            "properties": {
                "actual": {
                    "type": "string"
                },
                "createdAt": {
                    "type": "string"
                },
                "currency": {
                    "type": "string"
                },
                "date": {
                    "type": "string"
                },
                "event": {
                    "type": "string"
                },
                "forecast": {
                    "type": "string"
                },
                "hash": {
                    "type": "string"
                },
                "impact": {
                    "type": "string"
                },
                "previous": {
                    "type": "string"
                },
                "sourceURL": {
                    "type": "string"
                },
                "updatedAt": {
                    "type": "string"
                }
            }
        },
        "domain.EquityPoint": {
            "type": "object",
            "properties": {
                "balance": {
                    "type": "number",
                    "format": "float64"
                },
                "time": {
                    "type": "string"
                }
            }
        },
        "domain.ExposureMetrics": {
            "type": "object",
            "properties": {
                "averageExposureTime": {
                    "type": "number",
                    "format": "float64"
                },
                "averageLeverage": {
                    "type": "number",
                    "format": "float64"
                },
                "exposureRatio": {
                    "type": "number",
                    "format": "float64"
                },
                "maxExposureTime": {
                    "type": "number",
                    "format": "float64"
                }
            }
        },
        "domain.PositionSide": {
            "type": "string",
            "enum": [
                "DEAL_TYPE_BUY",
                "DEAL_TYPE_SELL"
            ],
            "x-enum-varnames": [
                "PositionSideBuy",
                "PositionSideSell"
            ]
        },
        "domain.PositionStatus": {
            "type": "string",
            "enum": [
                "open",
                "closed"
            ],
            "x-enum-varnames": [
                "PositionStatusOpen",
                "PositionStatusClosed"
            ]
        },
        "domain.RiskMetrics": {
            "type": "object",
            "properties": {
                "averageDownsideRisk": {
                    "type": "number",
                    "format": "float64"
                },
                "calmarRatio": {
                    "type": "number",
                    "format": "float64"
                },
                "conditionalVaR95": {
                    "type": "number",
                    "format": "float64"
                },
                "downsideDeviation": {
                    "type": "number",
                    "format": "float64"
                },
                "kurtosis": {
                    "type": "number",
                    "format": "float64"
                },
                "maxDrawdown": {
                    "type": "number",
                    "format": "float64"
                },
                "maxDrawdownPercent": {
                    "type": "number",
                    "format": "float64"
                },
                "recoveryFactor": {
                    "type": "number",
                    "format": "float64"
                },
                "sharpeRatio": {
                    "type": "number",
                    "format": "float64"
                },
                "skewness": {
                    "type": "number",
                    "format": "float64"
                },
                "sortinoRatio": {
                    "type": "number",
                    "format": "float64"
                },
                "stability": {
                    "type": "number",
                    "format": "float64"
                },
                "ulcerIndex": {
                    "type": "number",
                    "format": "float64"
                },
                "valueAtRisk95": {
                    "type": "number",
                    "format": "float64"
                },
                "volatility": {
                    "type": "number",
                    "format": "float64"
                }
            }
        },
        "domain.TradeMetrics": {
            "type": "object",
            "properties": {
                "averageDurationSec": {
                    "type": "number",
                    "format": "float64"
                },
                "averageLoss": {
                    "type": "number",
                    "format": "float64"
                },
                "averageRMultiple": {
                    "type": "number",
                    "format": "float64"
                },
                "averageWin": {
                    "type": "number",
                    "format": "float64"
                },
                "bestTrade": {
                    "type": "number",
                    "format": "float64"
                },
                "expectancy": {
                    "type": "number",
                    "format": "float64"
                },
                "losingTrades": {
                    "type": "integer"
                },
                "payoffRatio": {
                    "type": "number",
                    "format": "float64"
                },
                "profitFactor": {
                    "type": "number",
                    "format": "float64"
                },
                "totalTrades": {
                    "type": "integer"
                },
                "winRate": {
                    "type": "number",
                    "format": "float64"
                },
                "winningTrades": {
                    "type": "integer"
                },
                "worstTrade": {
                    "type": "number",
                    "format": "float64"
                }
            }
        },
        "domain.User": {
            "type": "object",
            "properties": {
                "broker": {
                    "type": "string"
                },
                "created": {
                    "type": "string"
                },
                "lastSeen": {
                    "type": "string"
                },
                "login": {
                    "type": "string"
                },
                "metadata": {
                    "type": "array",
                    "items": {
                        "type": "integer",
                        "format": "int32"
                    }
                },
                "name": {
                    "type": "string"
                },
                "platform": {
                    "type": "string"
                },
                "server": {
                    "type": "string"
                },
                "updated": {
                    "type": "string"
                },
                "userID": {
                    "type": "string"
                }
            }
        },
        "domain.UserPerformanceReport": {
            "type": "object",
            "properties": {
                "asOf": {
                    "type": "string"
                },
                "balanceCurve": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/domain.EquityPoint"
                    }
                },
                "closedPositions": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/domain.UserTrade"
                    }
                },
                "derivedInsights": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "equityCurve": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/domain.EquityPoint"
                    }
                },
                "exposureMetrics": {
                    "$ref": "#/definitions/domain.ExposureMetrics"
                },
                "openPositions": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/domain.UserPositionSnapshot"
                    }
                },
                "realizedProfit": {
                    "type": "number",
                    "format": "float64"
                },
                "riskMetrics": {
                    "$ref": "#/definitions/domain.RiskMetrics"
                },
                "totalReturnPercent": {
                    "type": "number",
                    "format": "float64"
                },
                "tradeMetrics": {
                    "$ref": "#/definitions/domain.TradeMetrics"
                },
                "unrealizedProfit": {
                    "type": "number",
                    "format": "float64"
                },
                "userID": {
                    "type": "string"
                }
            }
        },
        "domain.UserPositionSnapshot": {
            "type": "object",
            "properties": {
                "accountLogin": {
                    "type": "string"
                },
                "accountName": {
                    "type": "string"
                },
                "balance": {
                    "type": "number",
                    "format": "float64"
                },
                "brokerName": {
                    "type": "string"
                },
                "brokerServer": {
                    "type": "string"
                },
                "comment": {
                    "type": "string"
                },
                "createdAt": {
                    "type": "string"
                },
                "entryPrice": {
                    "type": "number",
                    "format": "float64"
                },
                "entryTime": {
                    "type": "string"
                },
                "lastUpdate": {
                    "type": "string"
                },
                "magic": {
                    "type": "integer",
                    "format": "int64"
                },
                "platform": {
                    "type": "string"
                },
                "profit": {
                    "type": "number",
                    "format": "float64"
                },
                "rawPayload": {
                    "type": "array",
                    "items": {
                        "type": "integer",
                        "format": "int32"
                    }
                },
                "reason": {
                    "type": "string"
                },
                "riskPercent": {
                    "type": "number",
                    "format": "float64"
                },
                "side": {
                    "$ref": "#/definitions/domain.PositionSide"
                },
                "status": {
                    "$ref": "#/definitions/domain.PositionStatus"
                },
                "stopLoss": {
                    "type": "number",
                    "format": "float64"
                },
                "symbol": {
                    "type": "string"
                },
                "takeProfit": {
                    "type": "number",
                    "format": "float64"
                },
                "tickSize": {
                    "type": "number",
                    "format": "float64"
                },
                "tickValue": {
                    "type": "number",
                    "format": "float64"
                },
                "ticket": {
                    "type": "integer",
                    "format": "int64"
                },
                "unrealizedPL": {
                    "type": "number",
                    "format": "float64"
                },
                "updatedAt": {
                    "type": "string"
                },
                "userID": {
                    "type": "string"
                },
                "volume": {
                    "type": "number",
                    "format": "float64"
                }
            }
        },
        "domain.UserTrade": {
            "type": "object",
            "properties": {
                "comment": {
                    "type": "string"
                },
                "createdAt": {
                    "type": "string"
                },
                "entryPrice": {
                    "type": "number",
                    "format": "float64"
                },
                "entryTime": {
                    "type": "string"
                },
                "entryType": {
                    "type": "string"
                },
                "magic": {
                    "type": "integer",
                    "format": "int64"
                },
                "platform": {
                    "type": "string"
                },
                "positionTicket": {
                    "type": "integer",
                    "format": "int64"
                },
                "profit": {
                    "type": "number",
                    "format": "float64"
                },
                "rawPayload": {
                    "type": "array",
                    "items": {
                        "type": "integer",
                        "format": "int32"
                    }
                },
                "reason": {
                    "type": "string"
                },
                "riskPercent": {
                    "type": "number",
                    "format": "float64"
                },
                "side": {
                    "type": "string"
                },
                "stopLoss": {
                    "type": "number",
                    "format": "float64"
                },
                "symbol": {
                    "type": "string"
                },
                "takeProfit": {
                    "type": "number",
                    "format": "float64"
                },
                "tickSize": {
                    "type": "number",
                    "format": "float64"
                },
                "tickValue": {
                    "type": "number",
                    "format": "float64"
                },
                "ticket": {
                    "type": "integer",
                    "format": "int64"
                },
                "updatedAt": {
                    "type": "string"
                },
                "userID": {
                    "type": "string"
                },
                "volume": {
                    "type": "number",
                    "format": "float64"
                }
            }
        },
        "http.PositionRequest": {
            "type": "object",
            "properties": {
                "balance": {
                    "type": "number"
                },
                "broker": {
                    "type": "string"
                },
                "login": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "platform": {
                    "type": "string"
                },
                "position": {
                    "$ref": "#/definitions/http.positionPayload"
                },
                "server": {
                    "type": "string"
                },
                "time": {
                    "type": "string"
                }
            }
        },
        "http.TradeRequest": {
            "type": "object",
            "properties": {
                "comment": {
                    "type": "string"
                },
                "entry": {
                    "type": "number"
                },
                "entryTime": {
                    "type": "string"
                },
                "entryType": {
                    "type": "string"
                },
                "magic": {
                    "type": "integer"
                },
                "pid": {
                    "type": "integer"
                },
                "profit": {
                    "type": "number"
                },
                "reason": {
                    "type": "string"
                },
                "riskPercent": {
                    "type": "number"
                },
                "side": {
                    "type": "string"
                },
                "sl": {
                    "type": "number"
                },
                "symbol": {
                    "type": "string"
                },
                "tickSize": {
                    "type": "number"
                },
                "tickValue": {
                    "type": "number"
                },
                "ticket": {
                    "type": "integer"
                },
                "tp": {
                    "type": "number"
                },
                "volume": {
                    "type": "number"
                }
            }
        },
        "http.TradingDataPosition": {
            "type": "object",
            "properties": {
                "comment": {
                    "type": "string"
                },
                "entry": {
                    "type": "number"
                },
                "entryTime": {
                    "type": "string"
                },
                "magic": {
                    "type": "integer"
                },
                "profit": {
                    "type": "number"
                },
                "reason": {
                    "type": "string"
                },
                "riskPercent": {
                    "type": "number"
                },
                "side": {
                    "type": "string"
                },
                "sl": {
                    "type": "number"
                },
                "symbol": {
                    "type": "string"
                },
                "tickSize": {
                    "type": "number"
                },
                "tickValue": {
                    "type": "number"
                },
                "ticket": {
                    "type": "integer"
                },
                "tp": {
                    "type": "number"
                },
                "volume": {
                    "type": "number"
                }
            }
        },
        "http.TradingDataRequest": {
            "type": "object",
            "properties": {
                "balance": {
                    "type": "number"
                },
                "broker": {
                    "type": "string"
                },
                "deals": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/http.TradeRequest"
                    }
                },
                "login": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "platform": {
                    "type": "string"
                },
                "position": {
                    "$ref": "#/definitions/http.TradingDataPosition"
                },
                "server": {
                    "type": "string"
                },
                "time": {
                    "type": "string"
                },
                "timeGMT": {
                    "type": "string"
                },
                "type": {
                    "description": "Type indicates payload category. Use \"History\" for historical trades; any other value is treated as a live position snapshot.",
                    "type": "string"
                }
            }
        },
        "http.positionPayload": {
            "type": "object",
            "properties": {
                "comment": {
                    "type": "string"
                },
                "entry": {
                    "type": "number"
                },
                "entryTime": {
                    "type": "string"
                },
                "magic": {
                    "type": "integer"
                },
                "profit": {
                    "type": "number"
                },
                "reason": {
                    "type": "string"
                },
                "riskPercent": {
                    "type": "number"
                },
                "side": {
                    "type": "string"
                },
                "sl": {
                    "type": "number"
                },
                "symbol": {
                    "type": "string"
                },
                "tickSize": {
                    "type": "number"
                },
                "tickValue": {
                    "type": "number"
                },
                "ticket": {
                    "type": "integer"
                },
                "tp": {
                    "type": "number"
                },
                "volume": {
                    "type": "number"
                }
            }
        }
    }
}